"use strict";(self.webpackChunkRestaurant=self.webpackChunkRestaurant||[]).push([[270],{3666:(N,v,l)=>{l.d(v,{h:()=>E});var s=l(7261),o=l(5e3),h=l(9808),f=l(5245),b=l(508);function e(d,g){1&d&&(o.TgZ(0,"mat-icon",13),o._uU(1," error "),o.qZA())}function x(d,g){1&d&&(o.TgZ(0,"mat-icon",14),o._uU(1," check_circle "),o.qZA())}function y(d,g){1&d&&(o.TgZ(0,"mat-icon",15),o._uU(1," warning "),o.qZA())}function C(d,g){1&d&&(o.TgZ(0,"mat-icon",16),o._uU(1," info "),o.qZA())}let E=(()=>{class d{constructor(c,m){this.data=c,this._snackRef=m}ngOnInit(){}dismiss(){this._snackRef.dismiss()}}return d.\u0275fac=function(c){return new(c||d)(o.Y36(s.qD),o.Y36(s.OX))},d.\u0275cmp=o.Xpm({type:d,selectors:[["app-snackbar"]],decls:15,vars:8,consts:[[1,"w-full","bg-white","rounded-lg","overflow-hidden"],[1,"p-4"],[1,"flex","items-center","justify-center"],["class","h-6 w-6 text-red-600 dark:text-red-700","aria-hidden","false","aria-label","Error",4,"ngIf"],["class","h-6 w-6 text-green-600 dark:text-green-700","aria-hidden","false","aria-label","Error",4,"ngIf"],["class","h-6 w-6 text-yellow-500","aria-hidden","false","aria-label","warning",4,"ngIf"],["class","h-6 w-6 text-blue-600 dark:text-blue-700","aria-hidden","false","aria-label","info",4,"ngIf"],[1,"ml-3","w-0","flex-1","text-sm","font-medium","text-gray-900"],[1,"ml-4","flex-shrink-0","flex"],["matRipple","",1,"bg-white","rounded-full","p-1","inline-flex","text-gray-400","hover:text-gray-500","focus:outline-none","custom-ripple",3,"matRippleCentered","matRippleDisabled","matRippleUnbounded","click"],[1,"sr-only"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor","aria-hidden","true",1,"h-5","w-5"],["fill-rule","evenodd","d","M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule","evenodd"],["aria-hidden","false","aria-label","Error",1,"h-6","w-6","text-red-600","dark:text-red-700"],["aria-hidden","false","aria-label","Error",1,"h-6","w-6","text-green-600","dark:text-green-700"],["aria-hidden","false","aria-label","warning",1,"h-6","w-6","text-yellow-500"],["aria-hidden","false","aria-label","info",1,"h-6","w-6","text-blue-600","dark:text-blue-700"]],template:function(c,m){1&c&&(o.TgZ(0,"div",0)(1,"div",1)(2,"div",2),o.YNc(3,e,2,0,"mat-icon",3),o.YNc(4,x,2,0,"mat-icon",4),o.YNc(5,y,2,0,"mat-icon",5),o.YNc(6,C,2,0,"mat-icon",6),o.TgZ(7,"p",7),o._uU(8),o.qZA(),o.TgZ(9,"div",8)(10,"button",9),o.NdJ("click",function(){return m.dismiss()}),o.TgZ(11,"span",10),o._uU(12,"Close"),o.qZA(),o.O4$(),o.TgZ(13,"svg",11),o._UZ(14,"path",12),o.qZA()()()()()()),2&c&&(o.xp6(3),o.Q6J("ngIf","E"==m.data.type),o.xp6(1),o.Q6J("ngIf","S"==m.data.type),o.xp6(1),o.Q6J("ngIf","W"==m.data.type),o.xp6(1),o.Q6J("ngIf","I"==m.data.type),o.xp6(2),o.hij(" ",null==m.data?null:m.data.message," "),o.xp6(2),o.Q6J("matRippleCentered",!1)("matRippleDisabled",!1)("matRippleUnbounded",!1))},directives:[h.O5,f.Hw,b.wG],styles:[""]}),d})()},4270:(N,v,l)=>{l.d(v,{G:()=>z});var s=l(3075),o=l(4987),h=l(3014),f=l.n(h),b=l(3666),e=l(5e3),x=l(5045),y=l(8966),C=l(7261),E=l(6444),d=l(9808),g=l(8814),c=l(508),m=l(5245);function J(i,p){1&i&&e._UZ(0,"app-loader",2)}const O=function(i){return{"border-2 border-red-500":i}},K=function(i,p){return{"bg-blue-200 hover:bg-blue-300":i,"bg-blue-600 hover:bg-blue-700":p}};function W(i,p){if(1&i){const t=e.EpF();e.TgZ(0,"div",6)(1,"form",7),e.NdJ("ngSubmit",function(){return e.CHM(t),e.oxw(2).sendOtp()}),e.TgZ(2,"h1",8),e._uU(3,"Log in or sign up to continue"),e.qZA(),e.TgZ(4,"div",9)(5,"div")(6,"label",10),e._uU(7,"Email address"),e.qZA(),e._UZ(8,"input",11),e.qZA(),e.TgZ(9,"div")(10,"label",12),e._uU(11,"Phone Number"),e.qZA(),e.TgZ(12,"div",13)(13,"div",14)(14,"label",15),e._uU(15,"Country"),e.qZA(),e.TgZ(16,"select",16)(17,"option"),e._uU(18),e.qZA()()(),e._UZ(19,"input",17),e.qZA()()(),e.TgZ(20,"div",18),e._uU(21),e.qZA(),e.TgZ(22,"button",19)(23,"span",20),e.O4$(),e.TgZ(24,"svg",21),e._UZ(25,"path",22),e.qZA()(),e._uU(26," Sent OTP "),e.qZA()()()}if(2&i){const t=e.oxw(2);let r,a;e.xp6(1),e.Q6J("formGroup",t.loginFormGroup),e.xp6(7),e.Q6J("ngClass",e.VKq(10,O,(null==(r=t.loginFormGroup.get("email"))?null:r.errors)&&((null==(r=t.loginFormGroup.get("email"))?null:r.touched)||(null==(r=t.loginFormGroup.get("email"))?null:r.dirty)))),e.xp6(10),e.Oqu(t.getCountryAndCode()),e.xp6(1),e.Q6J("ngClass",e.VKq(12,O,(null==(a=t.loginFormGroup.get("mobile"))?null:a.errors)&&((null==(a=t.loginFormGroup.get("mobile"))?null:a.touched)||(null==(a=t.loginFormGroup.get("mobile"))?null:a.dirty)))),e.xp6(2),e.Oqu(t.getErrors("loginFormGroup")),e.xp6(1),e.Q6J("disabled",t.loginFormGroup.invalid)("ngClass",e.WLB(14,K,t.loginFormGroup.invalid,!t.loginFormGroup.invalid))("matRippleCentered",!1)("matRippleDisabled",!1)("matRippleUnbounded",!1)}}function Q(i,p){if(1&i&&(e.TgZ(0,"span",38),e._uU(1),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.hij("in\xa0",t.timeLeft,"s")}}const Y=function(i){return{"text-gray-200":i}};function j(i,p){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"form",23),e.NdJ("ngSubmit",function(){return e.CHM(t),e.oxw(2).onLogin()}),e.TgZ(2,"div",24)(3,"div",25)(4,"h1",26),e._uU(5,"Enter OTP sent to"),e.qZA(),e.TgZ(6,"span",27),e._uU(7),e.qZA()(),e.TgZ(8,"button",28),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).resendOtp()}),e.TgZ(9,"mat-icon",29),e._uU(10,"sms"),e.qZA(),e.TgZ(11,"span",30),e._uU(12," Resend OTP\xa0 "),e.qZA(),e.YNc(13,Q,2,1,"span",31),e.qZA()(),e.TgZ(14,"div",9)(15,"div")(16,"label",32),e._uU(17,"Otp"),e.qZA(),e._UZ(18,"input",33),e.qZA()(),e.TgZ(19,"div",18),e._uU(20),e.qZA(),e.TgZ(21,"div")(22,"button",34)(23,"span",20),e.O4$(),e.TgZ(24,"svg",21),e._UZ(25,"path",22),e.qZA()(),e._uU(26," Login "),e.qZA(),e.kcU(),e.TgZ(27,"div",35),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return a.otpScreen=!1,a.loginScreen=!0}),e.TgZ(28,"mat-icon",36),e._uU(29,"chevron_left "),e.qZA(),e.TgZ(30,"a",37),e._uU(31," Back to login"),e.qZA()()()()()}if(2&i){const t=e.oxw(2);let r;e.xp6(1),e.Q6J("formGroup",t.loginFormOtpGroup),e.xp6(6),e.AsE("",t.getCountryCode(),"\xa0",t.loginFormGroup.value.mobile,""),e.xp6(1),e.Q6J("ngClass",e.VKq(16,Y,t.wait))("disabled",t.wait),e.xp6(5),e.Q6J("ngIf",0!=t.timeLeft&&60!=t.timeLeft),e.xp6(5),e.Q6J("ngClass",e.VKq(18,O,(null==(r=t.loginFormOtpGroup.get("otp"))?null:r.errors)&&((null==(r=t.loginFormOtpGroup.get("otp"))?null:r.touched)||(null==(r=t.loginFormOtpGroup.get("otp"))?null:r.dirty)))),e.xp6(2),e.Oqu(t.getErrors("loginFormOtpGroup")),e.xp6(2),e.Q6J("disabled",t.loginFormOtpGroup.invalid)("ngClass",e.WLB(20,K,t.loginFormOtpGroup.invalid,!t.loginFormOtpGroup.invalid))("matRippleCentered",!1)("matRippleDisabled",!1)("matRippleUnbounded",!1),e.xp6(5),e.Q6J("matRippleCentered",!1)("matRippleDisabled",!1)("matRippleUnbounded",!1)}}function H(i,p){if(1&i&&(e.TgZ(0,"div",3),e.YNc(1,W,27,17,"div",4),e.YNc(2,j,32,23,"div",5),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.otpScreen&&t.loginScreen),e.xp6(1),e.Q6J("ngIf",t.otpScreen&&!t.loginScreen)}}let z=(()=>{class i{constructor(t,r,a,u,_){this.formBuilder=t,this.mainService=r,this.dialog=a,this._snackBar=u,this.restaurantService=_,this.wait=!1,this.timeLeft=o.g.OTP_TIMER,this.mobileRegrex=/^[5-9]\d{9}$/,this.otpScreen=!1,this.loginScreen=!0,this.number=0,this.email="",this.loading=!1,this.loginFormGroup=this.formBuilder.group({email:["",[s.kI.required,s.kI.email]],mobile:["",[s.kI.required,s.kI.pattern(this.mobileRegrex)]]}),this.loginFormOtpGroup=this.formBuilder.group({otp:["",[s.kI.required,s.kI.maxLength(6)]]})}ngOnInit(){}resendOtp(){this.wait||this.sendOtp()}sendOtp(){this.loginScreen=!0,this.otpScreen=!1,this.loading=!0,this.loginFormOtpGroup.reset(),this.loading=!0;const t={email:this.loginFormGroup.value.email.toLowerCase(),number:this.loginFormGroup.value.mobile};this.restaurantService.getRestaurantSlug()&&f().post(o.g.BASE_URL+o.g.LOGIN_URL+`/${this.restaurantService.getRestaurantSlug()}`,t).then(r=>{this.wait=!0,this.startTimer(),this.otpScreen=!0,this.loginScreen=!1,this.number=this.loginFormGroup.value.mobile,this.email=this.loginFormGroup.value.email,this._snackBar.openFromComponent(b.h,{data:{message:"Otp sent successfully",type:"S"},panelClass:"snack-bar",horizontalPosition:"center",verticalPosition:"top",duration:1700}),this.loading=!1}).catch(r=>{this.loading=!1,console.log("Error",r),this.mainService.openDialog("Error",this.mainService.errorMessage(r),"E")})}onLogin(){if(this.loading=!0,0!=this.number){const t={number:this.number,otp:this.loginFormOtpGroup.value.otp};f().post(o.g.BASE_URL+o.g.VERIFY_USER_URL,t).then(r=>{this.timer&&clearInterval(this.timer),this.loginScreen=!1,this.otpScreen=!1;const a=r.data.jwt,u=this.mainService.getToLocalStorage(o.g.LOCAL_USER);u.number=this.number,u.email=this.email,u.username=r.data.user.username,u.countryCode=r.data.user.countryCode,u.country=r.data.user.country,u.confirmed=r.data.user.confirmed,u.blocked=r.data.user.blocked,u.fullName=r.data.user.fullName||"",u.jwt=a,u.id=r.data.user.id,this.mainService.setToLocalStorage(u,o.g.LOCAL_USER),this.loginFormOtpGroup.reset(),window.location.reload(),this.loading=!1}).catch(r=>{this.loading=!1,console.log("Error",r),this.mainService.openDialog("Error",this.mainService.errorMessage(r),"E")})}}getErrors(t){var r,a,u,_,T,Z,R,U,L,w,k,A,G,I,D,S,F,M,P,q,B;let n="";return"loginFormGroup"==t&&((null===(r=this.loginFormGroup.get("email"))||void 0===r?void 0:r.errors)&&((null===(a=this.loginFormGroup.get("email"))||void 0===a?void 0:a.touched)||(null===(u=this.loginFormGroup.get("email"))||void 0===u?void 0:u.dirty))||(null===(_=this.loginFormGroup.get("mobile"))||void 0===_?void 0:_.errors)&&((null===(T=this.loginFormGroup.get("mobile"))||void 0===T?void 0:T.touched)||(null===(Z=this.loginFormGroup.get("mobile"))||void 0===Z?void 0:Z.dirty)))&&((null===(U=null===(R=this.loginFormGroup.get("mobile"))||void 0===R?void 0:R.errors)||void 0===U?void 0:U.required)&&(n+="Mobile is required"),(null===(w=null===(L=this.loginFormGroup.get("email"))||void 0===L?void 0:L.errors)||void 0===w?void 0:w.required)&&((null==n?void 0:n.length)>0&&(n+=" & "),n+="Email is required"),(null===(A=null===(k=this.loginFormGroup.get("email"))||void 0===k?void 0:k.errors)||void 0===A?void 0:A.email)&&((null==n?void 0:n.length)>0&&(n+=" & "),n+="Email is invalid"),(null===(I=null===(G=this.loginFormGroup.get("mobile"))||void 0===G?void 0:G.errors)||void 0===I?void 0:I.pattern)&&((null==n?void 0:n.length)>0&&(n+=" & "),n+="Mobile is invalid")),"loginFormOtpGroup"==t&&(null===(D=this.loginFormOtpGroup.get("otp"))||void 0===D?void 0:D.errors)&&((null===(S=this.loginFormOtpGroup.get("otp"))||void 0===S?void 0:S.touched)||(null===(F=this.loginFormOtpGroup.get("otp"))||void 0===F?void 0:F.dirty))&&((null===(P=null===(M=this.loginFormOtpGroup.get("otp"))||void 0===M?void 0:M.errors)||void 0===P?void 0:P.required)&&(n+="Otp is required"),(null===(B=null===(q=this.loginFormOtpGroup.get("otp"))||void 0===q?void 0:q.errors)||void 0===B?void 0:B.maxLength)&&((null==n?void 0:n.length)>0&&(n+=" & "),n+="Otp length should be 6")),n}startTimer(){this.timer=setInterval(()=>{this.timeLeft>0?this.timeLeft--:(this.wait=!1,this.timeLeft=o.g.OTP_TIMER,clearInterval(this.timer))},1e3)}getCountryAndCode(){const t=this.restaurantService.getRestaurantData();return(null==t?void 0:t.country)+" "+(null==t?void 0:t.countryCode)}getCountryCode(){const t=this.restaurantService.getRestaurantData();return null==t?void 0:t.countryCode}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(s.qu),e.Y36(x.J),e.Y36(y.uw),e.Y36(C.ux),e.Y36(E.T))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-login"]],decls:2,vars:2,consts:[["class","absolute top-0 left-0",4,"ngIf"],["class","p-5 bg-white dark:bg-slate-800 ",4,"ngIf"],[1,"absolute","top-0","left-0"],[1,"p-5","bg-white","dark:bg-slate-800"],["class","space-y-6",4,"ngIf"],[4,"ngIf"],[1,"space-y-6"],[3,"formGroup","ngSubmit"],[1,"font-semibold","text-sm","mt-6","dark:text-white"],[1,"rounded-md","shadow-sm","mt-4","-space-y-px"],["for","email-address",1,"sr-only","dark:text-white"],["formControlName","email","name","email","type","email","autocomplete","email","required","","placeholder","Enter email address.",1,"dark:bg-slate-700","dark:placeholder:text-gray-400","dark:text-white","dark:ring-slate-600","dark:border-gray-500","appearance-none","rounded-none","relative","block","w-full","px-3","py-2","border","border-gray-300","placeholder-gray-500","text-gray-900","rounded-t-md","focus:outline-none","focus:ring-blue-500","focus:border-blue-500","focus:z-10","sm:text-sm",3,"ngClass"],["for","phone-number",1,"sr-only","dark:text-white"],[1,"relative","rounded-md","shadow-sm"],[1,"absolute","inset-y-0","left-0","flex","items-center"],["for","country",1,"sr-only"],["id","country","name","country","autocomplete","country",1,"focus:ring-blue-500","focus:border-blue-500","h-full","py-0","pl-3","pr-6","border-transparent","bg-transparent","dark:text-gray-400","text-gray-600","text-xs","rounded-md"],["formControlName","mobile","name","mobile","type","tel","autocomplete","mobile","required","","placeholder","  Enter mobile number",1,"block","w-full","pl-20","dark:bg-slate-700","dark:placeholder:text-gray-400","dark:text-white","dark:ring-slate-600","dark:border-gray-500","px-3","py-2","border","border-gray-300","placeholder-gray-500","text-gray-900","rounded-b-md","focus:outline-none","focus:ring-blue-500","focus:border-blue-500","focus:z-10","sm:text-sm",3,"ngClass"],[1,"text-red-500","text-xs","mt-2"],["type","submit","matRipple","",1,"group","relative","w-full","mt-4","flex","justify-center","py-2","px-4","border","border-transparent","text-sm","font-medium","rounded-md","text-white","bg-blue-600","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","custom-ripple",3,"disabled","ngClass","matRippleCentered","matRippleDisabled","matRippleUnbounded"],[1,"absolute","left-0","inset-y-0","flex","items-center","pl-3"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor","aria-hidden","true",1,"h-5","w-5","text-blue-500","group-hover:text-blue-400"],["fill-rule","evenodd","d","M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule","evenodd"],[1,"space-y-6",3,"formGroup","ngSubmit"],[1,"flex","justify-between","mt-6"],[1,"flex","flex-col"],[1,"font-semibold","text-sm","dark:text-white"],[1,"text-base","dark:text-gray-200","text-gray-800","font-bold","mt-4"],["matRipple","",1,"my-auto","rounded-lg","custom-ripple","inline-flex","items-center","px-2.5","py-1.5","border","border-gray-300","shadow-sm","text-xs","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"ngClass","disabled","click"],[1,"mr-1","text-base","text-gray-700","my-auto","flex","items-center"],[1,"text-gray-800","text-xs","cursor-pointer"],["class","text-blue-500 text-xs",4,"ngIf"],["for","otp",1,"sr-only"],["formControlName","otp","name","otp","type","tel","autocomplete","","required","","placeholder","Enter OTP",1,"dark:bg-slate-700","dark:placeholder:text-gray-400","dark:text-white","dark:ring-slate-600","dark:border-gray-500","appearance-none","relative","block","w-full","px-3","py-2","border","border-gray-300","placeholder-gray-500","text-gray-900","rounded-md","focus:outline-none","focus:ring-blue-500","focus:border-blue-500","focus:z-10","sm:text-sm",3,"ngClass"],["type","submit","matRipple","",1,"group","relative","w-full","flex","mt-4","justify-center","py-2","px-4","border","border-transparent","text-sm","font-medium","rounded-md","text-white","bg-blue-600","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","custom-ripple",3,"disabled","ngClass","matRippleCentered","matRippleDisabled","matRippleUnbounded"],["matRipple","",1,"flex","justify-center","items-center","mt-6","p-2","rounded-full","custom-ripple",3,"matRippleCentered","matRippleDisabled","matRippleUnbounded","click"],["aria-hidden","false","aria-label","back to home",1,"text-blue-500","text-sm"],[1,"text-blue-500","text-sm","cursor-pointer"],[1,"text-blue-500","text-xs"]],template:function(t,r){1&t&&(e.YNc(0,J,1,0,"app-loader",0),e.YNc(1,H,3,2,"div",1)),2&t&&(e.Q6J("ngIf",r.loading),e.xp6(1),e.Q6J("ngIf",!r.loading))},directives:[d.O5,g.R,s._Y,s.JL,s.sg,s.Fj,s.JJ,s.u,s.Q7,d.mk,s.YN,s.Kr,c.wG,m.Hw],styles:[""]}),i})()}}]);